#{to_json =>
      {with_defs,
          {#{<<"CommandAction">> =>
                 {any_of,
                     [{struct,
                          #{command => {required,binstr},
                            name => {required,binstr},
                            type => {required,{enum,[read]}},
                            path => {required,binstr}}},
                      {struct,
                          #{command => {required,binstr},
                            type => {required,{enum,[listFiles]}},
                            path =>
                                {optional,{any_of,[binstr,{exact,null}]}}}},
                      {struct,
                          #{command => {required,binstr},
                            type => {required,{enum,[search]}},
                            path => {optional,{any_of,[binstr,{exact,null}]}},
                            query =>
                                {optional,{any_of,[binstr,{exact,null}]}}}},
                      {struct,
                          #{command => {required,binstr},
                            type => {required,{enum,[unknown]}}}}]}},
           {struct,
               #{command => {optional,{any_of,[binstr,{exact,null}]}},
                 reason => {optional,{any_of,[binstr,{exact,null}]}},
                 cwd => {optional,{any_of,[binstr,{exact,null}]}},
                 threadId => {required,binstr},
                 turnId => {required,binstr},
                 commandActions =>
                     {optional,
                         {any_of,
                             [{list,{ref,<<"CommandAction">>}},{exact,null}]}},
                 itemId => {required,binstr},
                 proposedExecpolicyAmendment =>
                     {optional,{any_of,[{list,binstr},{exact,null}]}}}}}},
  from_json =>
      {with_defs,
          {#{<<"CommandAction">> =>
                 {any_of,
                     [{struct,
                          #{command => {required,binstr},
                            name => {required,binstr},
                            type => {required,{enum,[read]}},
                            path => {required,binstr}}},
                      {struct,
                          #{command => {required,binstr},
                            type => {required,{enum,[listFiles]}},
                            path =>
                                {optional,{any_of,[binstr,{exact,null}]}}}},
                      {struct,
                          #{command => {required,binstr},
                            type => {required,{enum,[search]}},
                            path => {optional,{any_of,[binstr,{exact,null}]}},
                            query =>
                                {optional,{any_of,[binstr,{exact,null}]}}}},
                      {struct,
                          #{command => {required,binstr},
                            type => {required,{enum,[unknown]}}}}]}},
           {struct,
               #{command => {optional,{any_of,[binstr,{exact,null}]}},
                 reason => {optional,{any_of,[binstr,{exact,null}]}},
                 cwd => {optional,{any_of,[binstr,{exact,null}]}},
                 threadId => {required,binstr},
                 turnId => {required,binstr},
                 commandActions =>
                     {optional,
                         {any_of,
                             [{list,{ref,<<"CommandAction">>}},{exact,null}]}},
                 itemId => {required,binstr},
                 proposedExecpolicyAmendment =>
                     {optional,{any_of,[{list,binstr},{exact,null}]}}}}}}}.
