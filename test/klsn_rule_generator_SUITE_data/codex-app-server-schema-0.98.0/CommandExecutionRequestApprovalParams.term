#{to_json =>
   {with_defs,
    {#{<<"CommandAction">> =>
        {any_of,
         [{struct,
           #{command => {required,binstr},
             name => {required,binstr},
             path => {required,binstr},
             type => {required,{enum,[<<"read">>]}}}},
          {struct,
           #{command => {required,binstr},
             path => {optional,{any_of,[binstr,{exact,null}]}},
             type => {required,{enum,[<<"listFiles">>]}}}},
          {struct,
           #{command => {required,binstr},
             path => {optional,{any_of,[binstr,{exact,null}]}},
             query => {optional,{any_of,[binstr,{exact,null}]}},
             type => {required,{enum,[<<"search">>]}}}},
          {struct,
           #{command => {required,binstr},
             type => {required,{enum,[<<"unknown">>]}}}}]}},
     {struct,
      #{command => {optional,{any_of,[binstr,{exact,null}]}},
        commandActions =>
         {optional,
          {any_of,[{list,{ref,<<"CommandAction">>}},{exact,null}]}},
        cwd => {optional,{any_of,[binstr,{exact,null}]}},
        itemId => {required,binstr},
        proposedExecpolicyAmendment =>
         {optional,{any_of,[{list,binstr},{exact,null}]}},
        reason => {optional,{any_of,[binstr,{exact,null}]}},
        threadId => {required,binstr},
        turnId => {required,binstr}}}}},
  from_json =>
   {with_defs,
    {#{<<"CommandAction">> =>
        {any_of,
         [{struct,
           #{command => {required,binstr},
             name => {required,binstr},
             path => {required,binstr},
             type => {required,{enum,[<<"read">>]}}}},
          {struct,
           #{command => {required,binstr},
             path => {optional,{any_of,[binstr,{exact,null}]}},
             type => {required,{enum,[<<"listFiles">>]}}}},
          {struct,
           #{command => {required,binstr},
             path => {optional,{any_of,[binstr,{exact,null}]}},
             query => {optional,{any_of,[binstr,{exact,null}]}},
             type => {required,{enum,[<<"search">>]}}}},
          {struct,
           #{command => {required,binstr},
             type => {required,{enum,[<<"unknown">>]}}}}]}},
     {struct,
      #{command => {optional,{any_of,[binstr,{exact,null}]}},
        commandActions =>
         {optional,
          {any_of,[{list,{ref,<<"CommandAction">>}},{exact,null}]}},
        cwd => {optional,{any_of,[binstr,{exact,null}]}},
        itemId => {required,binstr},
        proposedExecpolicyAmendment =>
         {optional,{any_of,[{list,binstr},{exact,null}]}},
        reason => {optional,{any_of,[binstr,{exact,null}]}},
        threadId => {required,binstr},
        turnId => {required,binstr}}}}}}.
